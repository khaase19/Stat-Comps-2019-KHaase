---
title: "Practicing_CLARANS"
output: pdf_document
---

```{r}
install.packages("devtools")
library(devtools)
install_github("QTCAT/qtcat")
```

```{r}
library("qtcat")
gfile <- system.file("extdata/snpdata.csv", package = "qtcat")
snp <- read.snpData(gfile, sep = ",")

clust <- clarans(snp, 3)
```

```{r, warning= FALSE}
library(readr)
data_subset <- read_csv("CopyOfdata_subset.csv")
```

```{r}
data_subset<- dplyr::filter(data_subset, !grepl("PUMA",geo_name))
```

```{r}
myvars <- c("Latitude_tri", "Longitude_tri", "X1")
newdata <- data_subset[myvars]
```


```{r}
snp <- read.snpData("CopyOfdata_subset", sep = ",")
clusttest <- clarans(newdata, 25)
```



##Practicing with CLARAS
Example from wikibooks

```{r}
install.packages("cluster")

library("cluster")
?daisy
```

```{r}
## import data
x <- USArrests

## run CLARA
clarax <- clara(x[1:4], 4)

## print components of clarax
print(clarax)

## plot clusters
plot(x, col = clarax$cluster)
## plot centers
points(clarax$centers, col = 1:2, pch = 8)
```
```{r}
#choosing K for CLARA
pkgs <- c("factoextra",  "NbClust")
install.packages(pkgs)

library(factoextra)
library(NbClust)

# Elbow method
fviz_nbclust(x, kmeans, method = "wss") +
    geom_vline(xintercept = 4, linetype = 2)+
  labs(subtitle = "Elbow method")

# Silhouette method
fviz_nbclust(x, kmeans, method = "silhouette")+
  labs(subtitle = "Silhouette method")

# Gap statistic
# nboot = 50 to keep the function speedy. 
# recommended value: nboot= 500 for your analysis.
# Use verbose = FALSE to hide computing progression.
set.seed(123)
fviz_nbclust(x, kmeans, nstart = 25,  method = "gap_stat", nboot = 50)+
  labs(subtitle = "Gap statistic method")
```

```{r}

##package cluster, called daisy--> notes from Kendall
install.packages("cluster")

library("cluster")

```

```{r, eval= FALSE}
#trying to find a good data package
eurodist
USAccDeaths
iris
crimtab
fdeaths
sleep
state.x77
```

```{r}
## import data
y <- state.x77

## run CLARA
claray <- clara(y[1:9],3)

## print components of clarax
print(claray)

## plot clusters
plot(y, col = claray$cluster)
## plot centers
points(claray$centers, col = 1:2, pch = 8)
```


#testing same data with CLARANS

```{r}
## run CLARA
claransx <- clarans(x[1:4], 3)

## print components of clarax
print(claransx)

## plot clusters
plot(x, col = claransx$cluster)
## plot centers
points(claransx$centers, col = 1:2, pch = 8)

```




Test from 
https://github.com/QTCAT/qtcat/blob/master/R/snpCluster.R

```{r}
gfile <- system.file("extdata/snpdata.csv", package = "qtcat")
snp <- read.snpData(gfile, sep = ",")

dist <- distCor(snp[, 1:10])

```


